<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ç¤¾å€å®¢æœç³»çµ±å¾Œå° Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .navbar-brand { font-weight: 800; letter-spacing:.5px; }
    .tile{
      position:relative;display:block;border:0;border-radius:18px;
      padding:24px;min-height:200px;background-size:cover;background-position:center;
      overflow:hidden;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.25);
      box-shadow:0 10px 24px rgba(0,0,0,.08);cursor:pointer;
      transition:transform .15s, box-shadow .15s, filter .15s;
    }
    .tile:hover{ transform:translateY(-2px);box-shadow:0 16px 36px rgba(0,0,0,.14);filter:saturate(1.05);}
    .tile-overlay{ position:absolute; inset:0; background:rgba(0,163,153,.88); }
    .tile-items{ line-height:1.9; font-weight:600; opacity:.98; }
  </style>
</head>
<body>

<!-- å°è¦½åˆ— -->
<nav class="navbar navbar-expand-lg bg-white border-bottom">
  <div class="container">
    <a class="navbar-brand fw-bold" href="#!" onclick="backHome()">ç¤¾å€å®¢æœç³»çµ±</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#topNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="topNav">

      <!-- ä¸­é–“ï¼šäº”å¤§åˆ†é¡ -->
      <ul class="navbar-nav ms-3">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">ğŸ  ä½æˆ¶èˆ‡äººå“¡ç®¡ç†é¡</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('resident')">ä½æˆ¶è³‡æ–™</a></li>
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('staff')">ä¸»å§”ã€æ¸…æ½”äººå“¡è³‡æ–™</a></li>
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('visitor')">è¨ªå®¢ç´€éŒ„</a></li>
          </ul>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">ğŸ’° è²¡å‹™èˆ‡ç®¡ç†é¡</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('fee')">ç®¡ç†è²»</a></li>
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('expenditure')">è²¡å‹™æ”¯å‡º</a></li>
          </ul>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">ğŸ“¢ å…¬å‘Šèˆ‡æ´»å‹•é¡</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('announcement')">ç¤¾å€å…¬å‘Š</a></li>
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('activity')">ç¤¾å€æ´»å‹•æ™‚ç¨‹</a></li>
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('meeting')">æœƒè­°ç´€éŒ„</a></li>
          </ul>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">ğŸ› ï¸ ç¶­ä¿®èˆ‡å®¢æœé¡</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('repair')">å ±ä¿®ç”³è«‹</a></li>
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('maintenance')">ç¶­ä¿®ã€ä¿é¤Šç´€éŒ„</a></li>
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('qa')">å®¢æœå•ç­”</a></li>
          </ul>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">ğŸ“¦ ä¿¡ä»¶èˆ‡åŒ…è£¹ç®¡ç†é¡</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#!" onclick="gotoTab('parcel')">ä¿¡ä»¶åŒ…è£¹</a></li>
          </ul>
        </li>
      </ul>

      <!-- å³å´ï¼šåˆ‡æ›åˆ°ä½æˆ¶ + èªè­‰ -->
      <div class="ms-auto d-flex align-items-center gap-3">
        <a class="text-decoration-none text-secondary" href="index.html">ç¤¾å€ç³»çµ±å¾Œå°</a>

        <div id="authCta" class="d-flex gap-2">
          <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#authModal" onclick="switchAuth('login')">ç™»å…¥</button>
          <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#authModal" onclick="switchAuth('register')">è¨»å†Š</button>
        </div>

        <!-- ä½¿ç”¨è€…ä¸‹æ‹‰ï¼šå·²ç§»é™¤ã€Œå›åˆ°é¦–é ã€ï¼Œæ–°å¢ ä¿®æ”¹è³‡æ–™ / å¿˜è¨˜å¯†ç¢¼ -->
        <div id="authUser" class="dropdown d-none">
          <button class="btn btn-sm btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown">
            <span id="authName">ä½æˆ¶</span>
          </button>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><h6 class="dropdown-header" id="authMail">user@example.com</h6></li>
            <li><a class="dropdown-item" href="#!" data-bs-toggle="modal" data-bs-target="#profileModal">ä¿®æ”¹è³‡æ–™</a></li>
            <li><a class="dropdown-item" href="#!" data-bs-toggle="modal" data-bs-target="#resetPwdModal">å¿˜è¨˜å¯†ç¢¼</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item text-danger" href="#!" onclick="logout()">ç™»å‡º</a></li>
          </ul>
        </div>
      </div>

    </div>
  </div>
</nav>

<!-- ===== å…§å®¹å€ ===== -->
<div class="container py-4">
  <div class="text-center mb-5">
    <h2 class="fw-bold display-6 mb-2">åŠŸèƒ½èˆ‡æœå‹™</h2>
  </div>

  <div class="row g-4 mb-4" id="feature-grid"></div>

  <div class="row g-4">
    <main class="col-12">
      <div class="card shadow-sm">
        <div class="card-body">
          <!-- åŠŸèƒ½åˆ—ï¼ˆé¦–é éš±è—ï¼›é€²å…¥åˆ†é æ‰é¡¯ç¤ºï¼‰ -->
          <div id="actionBar" class="action-bar mb-3 d-none">
            <button class="btn btn-success requires-auth" data-action="æ–°å¢">æ–°å¢</button>
            <button class="btn btn-outline-primary requires-auth" data-action="ç·¨è¼¯">ç·¨è¼¯</button>
          </div>
          <div id="tab-content"><!-- JS æ³¨å…¥ --></div>
        </div>
      </div>
    </main>
  </div>
</div>

<!-- ===== ç™»å…¥/è¨»å†Š Modal ===== -->
<div class="modal fade" id="authModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="authTitle" class="modal-title">ç™»å…¥</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div id="loginForm">
          <div class="mb-3">
            <label class="form-label">Email</label>
            <input id="loginEmail" type="email" class="form-control" placeholder="name@example.com">
          </div>
          <div class="mb-3">
            <label class="form-label">å¯†ç¢¼</label>
            <input id="loginPwd" type="password" class="form-control" placeholder="è‡³å°‘ 6 ç¢¼">
          </div>
          <button id="loginBtn" class="btn btn-primary w-100" onclick="handleLogin()">ç™»å…¥</button>
          <div class="mt-2 small text-muted">æ¸¬è©¦å¸³å¯†ï¼štest@example.com / 123456</div>
        </div>
        <div id="registerForm" class="d-none">
          <div class="mb-3">
            <label class="form-label">Email</label>
            <input id="regEmail" type="email" class="form-control" placeholder="name@example.com">
          </div>
          <div class="mb-3">
            <label class="form-label">é¡¯ç¤ºåç¨±</label>
            <input id="regName" type="text" class="form-control" placeholder="ç‹å°æ˜">
          </div>
          <div class="mb-3">
            <label class="form-label">å¯†ç¢¼</label>
            <input id="regPwd" type="password" class="form-control" placeholder="è‡³å°‘ 6 ç¢¼">
          </div>
          <button class="btn btn-success w-100" onclick="handleRegister()">å»ºç«‹å¸³è™Ÿ</button>
        </div>
      </div>
      <div class="modal-footer">
        <button id="switchAuthBtn" class="btn btn-link" onclick="toggleAuth()">åˆ‡æ›åˆ°è¨»å†Š</button>
      </div>
    </div>
  </div>
</div>

<!-- ä¿®æ”¹è³‡æ–™ Modal -->
<div class="modal fade" id="profileModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">ä¿®æ”¹è³‡æ–™</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label">Emailï¼ˆä¸å¯ä¿®æ”¹ï¼‰</label>
          <input id="pfEmail" type="email" class="form-control" disabled>
        </div>
        <div class="mb-3">
          <label class="form-label">é¡¯ç¤ºåç¨±</label>
          <input id="pfName" type="text" class="form-control" placeholder="æ‚¨çš„åç¨±">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
        <button class="btn btn-primary" onclick="saveProfile()">å„²å­˜</button>
      </div>
    </div>
  </div>
</div>

<!-- å¿˜è¨˜å¯†ç¢¼ Modal -->
<div class="modal fade" id="resetPwdModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">å¿˜è¨˜å¯†ç¢¼</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-2 small text-muted">Demoï¼šå°‡æ¨¡æ“¬å¯„å‡ºé‡è¨­å¯†ç¢¼é€£çµåˆ°æ‚¨çš„ Emailã€‚</div>
        <div class="mb-3">
          <label class="form-label">Email</label>
          <input id="fpEmail" type="email" class="form-control" placeholder="name@example.com">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
        <button class="btn btn-primary" onclick="sendReset()">å¯„é€é‡è¨­ä¿¡</button>
      </div>
    </div>
  </div>
</div>

<script>
/* ===== å‡è³‡æ–™ï¼ˆåŒå‰ï¼‰ ===== */
const demoResidents = [
  { id: 1, name: "ç‹å¤§æ˜", room: "A101", phone: "0912-345678", car: "ABC-1234", moveIn: "2021-09-01", family: "ç‹å¤ªå¤ªã€ç‹å°æ˜" },
  { id: 2, name: "æ—å°ç¾", room: "A102", phone: "0922-222222", car: "XYZ-5678", moveIn: "2023-06-15", family: "æ—çˆ¸çˆ¸ã€æ—åª½åª½" },
];
const demoStaff = [
  { id: 1, name: "æä¸»å§”", role: "ä¸»å§”", phone: "0933-111111" },
  { id: 2, name: "é™³æ¸…æ½”", role: "æ¸…æ½”äººå“¡", phone: "0933-222222" },
];
const demoVisitors = [
  { id: 1, name: "é™³è¨ªå®¢", idCard: "A123456789", room: "A101", in: "2025-08-22 10:00", out: "2025-08-22 11:00", note: "é€æ–‡ä»¶" },
];
const demoFees = [
  { id: 1, room: "A101", amount: 1200, due: "2025-09-10", paid: true, invoice: "INV20250801" },
  { id: 2, room: "A102", amount: 1200, due: "2025-09-10", paid: false, invoice: "INV20250802" },
];
const demoAnnouncements = [
  { id: 1, title: "åœæ°´é€šçŸ¥", content: "8/25ä¸Šåˆ9~12é»åœæ°´ã€‚", time: "2025-08-20", author: "æä¸»å§”", attachment: "" },
];
const demoActivities = [
  { id: 1, name: "ä¸­ç§‹çƒ¤è‚‰", time: "2025-09-15 18:00", location: "ä¸­åº­", signup: "ç¾å ´å ±å", organizer: "ç‹å¤§æ˜" },
];
const demoRepairs = [
  { id: 1, room: "A101", item: "æ°´é¾é ­æ¼æ°´", desc: "å»šæˆ¿æ°´é¾é ­æŒçºŒæ»´æ°´", time: "2025-08-21", status: "è™•ç†ä¸­", handler: "é™³æ¸…æ½”" },
];
const demoMaintenances = [
  { id: 1, equipment: "é›»æ¢¯", item: "å¹´åº¦ä¿é¤Š", time: "2025-08-10", handler: "ä¿é¤Šå…¬å¸", cost: 8000, note: "æ­£å¸¸" },
];
const demoQA = [
  { id: 1, room: "A101", q: "åƒåœ¾æ€éº¼åˆ†é¡ï¼Ÿ", a: "è«‹ä¾å…¬å‘Šåˆ†é¡", status: "å·²å›è¦†", time: "2025-08-19" },
];
const demoMeetings = [
  { id: 1, topic: "è²¡å‹™å¯©æŸ¥", time: "2025-08-18", location: "æœƒè­°å®¤", participants: "ä¸»å§”ã€ä½æˆ¶ä»£è¡¨", record: "è¨è«–æ”¶æ”¯", resolution: "é€šé" },
];
const demoExpenditures = [
  { id: 1, item: "æ¸…æ½”ç”¨å“", amount: 1500, date: "2025-08-12", purpose: "å¤§æ¨“æ¸…æ½”", proof: "æ”¶æ“š" },
];
const demoParcels = [
  { id: 1, receiver: "ç‹å¤§æ˜", room: "A101", code: "PKG12345", arrival: "2025-08-21 14:00", received: true },
];

/* ===== tabs / cardsï¼š12 é … ===== */
const tabs = [
  { key:"resident", label:"ä½æˆ¶è³‡æ–™" },
  { key:"staff", label:"ä¸»å§”ã€æ¸…æ½”äººå“¡è³‡æ–™" },
  { key:"visitor", label:"è¨ªå®¢ç´€éŒ„" },
  { key:"fee", label:"ç®¡ç†è²»" },
  { key:"announcement", label:"ç¤¾å€å…¬å‘Š" },
  { key:"activity", label:"ç¤¾å€æ´»å‹•æ™‚ç¨‹" },
  { key:"repair", label:"å ±ä¿®ç”³è«‹" },
  { key:"maintenance", label:"ç¶­ä¿®ã€ä¿é¤Šç´€éŒ„" },
  { key:"qa", label:"å®¢æœå•ç­”" },
  { key:"meeting", label:"æœƒè­°ç´€éŒ„" },
  { key:"expenditure", label:"è²¡å‹™æ”¯å‡º" },
  { key:"parcel", label:"ä¿¡ä»¶åŒ…è£¹" },
];

const cards = [
  ["resident","ä½æˆ¶è³‡æ–™","åŸºæœ¬è³‡æ–™ ï½œ ä½æˆ¶è¯çµ¡ ï½œ è»Šä½ ï½œ å®¶åº­æˆå“¡","https://images.unsplash.com/photo-1581091215367-59ab6b3d6321?q=80&w=1600&auto=format&fit=crop"],
  ["staff","ä¸»å§”ã€æ¸…æ½”äººå“¡è³‡æ–™","ä¸»å§” ï½œ æ¸…æ½”äººå“¡","https://images.unsplash.com/photo-1551836022-d5d88e9218df?q=80&w=1600&auto=format&fit=crop"],
  ["visitor","è¨ªå®¢ç´€éŒ„","è¨ªå®¢ç™»è¨˜ ï½œ åˆ°é›¢ç´€éŒ„","https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?q=80&w=1600&auto=format&fit=crop"],
  ["fee","ç®¡ç†è²»","é‡‘é¡ ï½œ åˆ°æœŸæ—¥ ï½œ ç™¼ç¥¨","https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?q=80&w=1600&auto=format&fit=crop"],
  ["announcement","ç¤¾å€å…¬å‘Š","åœæ°´åœé›» ï½œ å€å‹™é€šçŸ¥","https://images.unsplash.com/photo-1529336953121-ad5a0d43d0d2?q=80&w=1600&auto=format&fit=crop"],
  ["activity","ç¤¾å€æ´»å‹•æ™‚ç¨‹","æ´»å‹•è³‡è¨Š ï½œ å ±åæ–¹å¼","https://images.unsplash.com/photo-1529333166437-7750a6dd5a70?q=80&w=1600&auto=format&fit=crop"],
  ["repair","å ±ä¿®ç”³è«‹","ç·šä¸Šå ±ä¿® ï½œ é€²åº¦è¿½è¹¤","https://images.unsplash.com/photo-1503387762-592deb58ef4e?q=80&w=1600&auto=format&fit=crop"],
  ["maintenance","ç¶­ä¿®ã€ä¿é¤Šç´€éŒ„","è¨­å‚™ ï½œ é …ç›® ï½œ èŠ±è²»","https://images.unsplash.com/photo-1518779578993-ec3579fee39f?q=80&w=1600&auto=format&fit=crop"],
  ["qa","å®¢æœå•ç­”","æå•å›è¦† ï½œ è™•ç†ç‹€æ…‹","https://images.unsplash.com/photo-1525186402429-b4ff38bedbec?q=80&w=1600&auto=format&fit=crop"],
  ["meeting","æœƒè­°ç´€éŒ„","ä¸»é¡Œ ï½œ æ±ºè­°äº‹é …","https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=1600&auto=format&fit=crop"],
  ["expenditure","è²¡å‹™æ”¯å‡º","é …ç›® ï½œ é‡‘é¡ ï½œ æ†‘è­‰","https://images.unsplash.com/photo-1521540216272-a50305cd4421?q=80&w=1600&auto=format&fit=crop"],
  ["parcel","ä¿¡ä»¶åŒ…è£¹","æ”¶ç™¼ä»¶ ï½œ å–ä»¶ç¢¼","https://images.unsplash.com/photo-1540573133985-87b6da6d54a9?q=80&w=1600&auto=format&fit=crop"],
];

/* ===== èªè­‰ï¼ˆlocalStorage æ¨¡æ“¬ï¼‰ ===== */
const AUTH_KEY="demo_auth_user";
let activeTab=null;

const isLoggedIn=()=>!!localStorage.getItem(AUTH_KEY);
const getUser =()=>JSON.parse(localStorage.getItem(AUTH_KEY)||"null");
const setUser =u=>localStorage.setItem(AUTH_KEY,JSON.stringify(u));
const clearUser=()=>localStorage.removeItem(AUTH_KEY);

function updateAuthUI(){
  const cta=document.getElementById('authCta');
  const user=document.getElementById('authUser');
  if(isLoggedIn()){
    const u=getUser()||{};
    cta.classList.add('d-none'); user.classList.remove('d-none');
    document.getElementById('authName').textContent=u.name||u.email||'ä½¿ç”¨è€…';
    document.getElementById('authMail').textContent=u.email||'user@example.com';
    unlockActions();
  }else{
    cta.classList.remove('d-none'); user.classList.add('d-none');
    lockActions();
  }
}

/* ===== é¦–é å¡ç‰‡ ===== */
function renderCards(){
  const grid=document.getElementById('feature-grid');
  grid.innerHTML=cards.map(([key,title,items,bg])=>`
    <div class="col-12 col-md-6 col-lg-4">
      <button class="tile w-100 text-start" style="background-image:url('${bg}')" onclick="gotoTab('${key}')">
        <div class="tile-overlay"></div>
        <div class="position-relative">
          <div class="h5 fw-bold mb-2 text-white">${title}</div>
          <div class="tile-items">${items}</div>
        </div>
      </button>
    </div>
  `).join('');
}

/* ===== é¦–é  / åˆ†é åˆ‡æ› ===== */
function backHome(){
  document.getElementById('feature-grid').classList.remove('d-none');
  document.getElementById('tab-content').innerHTML="";
  document.getElementById('actionBar').classList.add('d-none');  // é¦–é éš±è—åŠŸèƒ½åˆ—
  activeTab=null;
  renderCards();
}

function gotoTab(key){
  activeTab=key;
  document.getElementById('feature-grid').classList.add('d-none');
  document.getElementById('actionBar').classList.remove('d-none'); // é€²å…¥åˆ†é é¡¯ç¤ºåŠŸèƒ½åˆ—
  renderTabContent();
}

/* ===== åŠŸèƒ½é–å®šï¼ˆæœªç™»å…¥ï¼‰ ===== */
function lockActions(){
  document.querySelectorAll('.requires-auth').forEach(btn=>{
    btn.disabled=false; // æ”¹ç‚ºæç¤ºç™»å…¥
    btn.onclick=(e)=>{
      e.preventDefault();
      switchAuth('login');
      const modal=new bootstrap.Modal(document.getElementById('authModal'));
      modal.show();
    };
  });
}
function unlockActions(){
  document.querySelectorAll('.requires-auth').forEach(btn=>{ btn.onclick=null; });
}

/* ===== åˆ†é å…§å®¹ + é€šç”¨æœå°‹ ===== */
function renderTabContent(){
  const PLACEHOLDER_MAP = {
    resident:     'æœå°‹ï¼šå§“å / æˆ¿è™Ÿ / é›»è©±',
    staff:        'æœå°‹ï¼šå§“å / è·ä½',
    visitor:      'æœå°‹ï¼šå§“å / æˆ¿è™Ÿ / æ™‚é–“',
    fee:          'æœå°‹ï¼šæˆ¿è™Ÿ / ç™¼ç¥¨',
    announcement: 'æœå°‹ï¼šæ¨™é¡Œ / å…§å®¹ / ç™¼å¸ƒäºº',
    activity:     'æœå°‹ï¼šæ´»å‹• / åœ°é»',
    repair:       'æœå°‹ï¼šæˆ¿è™Ÿ / é …ç›® / ç‹€æ…‹',
    maintenance:  'æœå°‹ï¼šè¨­å‚™ / é …ç›® / è² è²¬äºº',
    qa:           'æœå°‹ï¼šå•é¡Œ / å›è¦† / æˆ¿è™Ÿ',
    meeting:      'æœå°‹ï¼šä¸»é¡Œ / åœ°é» / åƒèˆ‡äºº',
    expenditure:  'æœå°‹ï¼šé …ç›® / ç”¨é€” / é‡‘é¡',
    parcel:       'æœå°‹ï¼šæ”¶ä»¶äºº / åŒ…è£¹ç·¨è™Ÿ'
  };
  let html = "";

  if(activeTab==="resident"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-primary"><tr>
          <th>å§“å</th><th>æˆ¿è™Ÿ</th><th>è¯çµ¡æ–¹å¼</th><th>è»Šä½</th><th>å…¥ä½æ™‚é–“</th><th>å®¶åº­æˆå“¡</th>
        </tr></thead><tbody>
          ${demoResidents.map(r=>`<tr><td>${r.name}</td><td>${r.room}</td><td>${r.phone}</td><td>${r.car}</td><td>${r.moveIn}</td><td>${r.family}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>ä½æˆ¶è³‡æ–™</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  if(activeTab==="staff"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-info"><tr><th>å§“å</th><th>è·ä½</th><th>è¯çµ¡æ–¹å¼</th></tr></thead><tbody>
          ${demoStaff.map(s=>`<tr><td>${s.name}</td><td>${s.role}</td><td>${s.phone}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>ä¸»å§”ã€æ¸…æ½”äººå“¡è³‡æ–™</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  if(activeTab==="visitor"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-secondary"><tr>
          <th>å§“å</th><th>èº«åˆ†è­‰</th><th>æ‹œè¨ªæˆ¿è™Ÿ</th><th>é€²å…¥æ™‚é–“</th><th>é›¢é–‹æ™‚é–“</th><th>å‚™è¨»</th>
        </tr></thead><tbody>
          ${demoVisitors.map(v=>`<tr><td>${v.name}</td><td>${v.idCard}</td><td>${v.room}</td><td>${v.in}</td><td>${v.out}</td><td>${v.note}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>è¨ªå®¢ç´€éŒ„</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  if(activeTab==="fee"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-warning"><tr><th>æˆ¿è™Ÿ</th><th>é‡‘é¡</th><th>åˆ°æœŸæ—¥</th><th>å·²ç¹³</th><th>ç™¼ç¥¨è™Ÿç¢¼</th></tr></thead><tbody>
          ${demoFees.map(f=>`<tr><td>${f.room}</td><td>${f.amount}</td><td>${f.due}</td><td>${f.paid?'æ˜¯':'å¦'}</td><td>${f.invoice}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>ç®¡ç†è²»</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  if(activeTab==="announcement"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-success"><tr><th>æ¨™é¡Œ</th><th>å…§å®¹</th><th>ç™¼å¸ƒæ™‚é–“</th><th>ç™¼å¸ƒäºº</th><th>é™„ä»¶</th></tr></thead><tbody>
          ${demoAnnouncements.map(a=>`<tr><td>${a.title}</td><td>${a.content}</td><td>${a.time}</td><td>${a.author}</td><td>${a.attachment}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>ç¤¾å€å…¬å‘Š</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  if(activeTab==="activity"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-success"><tr><th>æ´»å‹•åç¨±</th><th>æ™‚é–“</th><th>åœ°é»</th><th>å ±åæ–¹å¼</th><th>è² è²¬äºº</th></tr></thead><tbody>
          ${demoActivities.map(a=>`<tr><td>${a.name}</td><td>${a.time}</td><td>${a.location}</td><td>${a.signup}</td><td>${a.organizer}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>ç¤¾å€æ´»å‹•æ™‚ç¨‹</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  if(activeTab==="repair"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-danger"><tr><th>æˆ¿è™Ÿ</th><th>é …ç›®</th><th>æè¿°</th><th>ç”³è«‹æ™‚é–“</th><th>ç‹€æ…‹</th><th>è² è²¬äºº</th></tr></thead><tbody>
          ${demoRepairs.map(r=>`<tr><td>${r.room}</td><td>${r.item}</td><td>${r.desc}</td><td>${r.time}</td><td>${r.status}</td><td>${r.handler}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>å ±ä¿®ç”³è«‹</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  if(activeTab==="maintenance"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-info"><tr><th>è¨­å‚™åç¨±</th><th>ä¿é¤Šé …ç›®</th><th>æ™‚é–“</th><th>è² è²¬äºº</th><th>èŠ±è²»</th><th>ç´€éŒ„</th></tr></thead><tbody>
          ${demoMaintenances.map(m=>`<tr><td>${m.equipment}</td><td>${m.item}</td><td>${m.time}</td><td>${m.handler}</td><td>${m.cost}</td><td>${m.note}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>ç¶­ä¿®ã€ä¿é¤Šç´€éŒ„</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  if(activeTab==="qa"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-info"><tr><th>æˆ¿è™Ÿ</th><th>å•é¡Œ</th><th>å›è¦†</th><th>ç‹€æ…‹</th><th>æ™‚é–“</th></tr></thead><tbody>
          ${demoQA.map(q=>`<tr><td>${q.room}</td><td>${q.q}</td><td>${q.a}</td><td>${q.status}</td><td>${q.time}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>å®¢æœå•ç­”</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  if(activeTab==="meeting"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-info"><tr><th>ä¸»é¡Œ</th><th>æ™‚é–“</th><th>åœ°é»</th><th>åƒèˆ‡äººå“¡</th><th>ç´€éŒ„</th><th>æ±ºè­°äº‹é …</th></tr></thead><tbody>
          ${demoMeetings.map(m=>`<tr><td>${m.topic}</td><td>${m.time}</td><td>${m.location}</td><td>${m.participants}</td><td>${m.record}</td><td>${m.resolution}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>æœƒè­°ç´€éŒ„</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  if(activeTab==="expenditure"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-warning"><tr><th>æ”¯å‡ºé …ç›®</th><th>é‡‘é¡</th><th>æ—¥æœŸ</th><th>ç”¨é€”</th><th>æ†‘è­‰</th></tr></thead><tbody>
          ${demoExpenditures.map(e=>`<tr><td>${e.item}</td><td>${e.amount}</td><td>${e.date}</td><td>${e.purpose}</td><td>${e.proof}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>è²¡å‹™æ”¯å‡º</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  if(activeTab==="parcel"){
    const tableHtml = `
      <div class="table-responsive"><table class="table table-bordered table-sm mt-3">
        <thead class="table-secondary"><tr><th>æ”¶ä»¶äºº</th><th>æˆ¿è™Ÿ</th><th>åŒ…è£¹ç·¨è™Ÿ</th><th>åˆ°é”æ™‚é–“</th><th>é ˜å–ç‹€æ…‹</th></tr></thead><tbody>
          ${demoParcels.map(p=>`<tr><td>${p.receiver}</td><td>${p.room}</td><td>${p.code}</td><td>${p.arrival}</td><td>${p.received?'å·²é ˜å–':'æœªé ˜å–'}</td></tr>`).join('')}
        </tbody></table></div>`;
    html = `<h4>ä¿¡ä»¶åŒ…è£¹</h4>` + withSearch(tableHtml, PLACEHOLDER_MAP[activeTab]);
  }

  document.getElementById('tab-content').innerHTML = html;
}

function withSearch(tableBlockHtml, placeholder='é—œéµå­—æœå°‹'){
  const id = 'tbl_' + Math.random().toString(36).slice(2,8);
  return `
    <div class="mb-2">
      <input class="form-control form-control-sm" placeholder="${placeholder}"
        oninput="(function(q){
          const wrap = document.getElementById('${id}');
          if(!wrap) return;
          const trs = wrap.querySelectorAll('tbody tr');
          const key = q.value.trim().toLowerCase();
          trs.forEach(tr => {
            tr.style.display = key==='' || tr.textContent.toLowerCase().includes(key) ? '' : 'none';
          });
        })(this)">
    </div>
    <div id="${id}">
      ${tableBlockHtml}
    </div>
  `;
}

/* ===== ç™»å…¥/è¨»å†Š ===== */
let authMode='login';
function switchAuth(mode){
  authMode=mode;
  document.getElementById('authTitle').textContent=(mode==='login'?'ç™»å…¥':'è¨»å†Š');
  document.getElementById('loginForm').classList.toggle('d-none',mode!=='login');
  document.getElementById('registerForm').classList.toggle('d-none',mode!=='register');
  document.getElementById('switchAuthBtn').textContent=(mode==='login'?'åˆ‡æ›åˆ°è¨»å†Š':'åˆ‡æ›åˆ°ç™»å…¥');
}
function toggleAuth(){ switchAuth(authMode==='login'?'register':'login'); }

function handleLogin(){
  const email=document.getElementById('loginEmail').value.trim();
  const pwd=document.getElementById('loginPwd').value.trim();
  if(!email || pwd.length<6){ alert('è«‹è¼¸å…¥æ­£ç¢º Email èˆ‡è‡³å°‘ 6 ç¢¼å¯†ç¢¼'); return; }
  const name=(email==='test@example.com'&&pwd==='123456')?'ç®¡ç†å“¡':email.split('@')[0];
  setUser({email,name}); updateAuthUI();

  // ä¿éšªå¼é—œé–‰ Modalï¼Œç¢ºä¿ alert æœƒè·³å‡º
  const modalEl=document.getElementById('authModal');
  let modal=bootstrap.Modal.getInstance(modalEl);
  if(!modal) modal=new bootstrap.Modal(modalEl);
  modal.hide();

  alert('ç™»å…¥æˆåŠŸ');
}
function handleRegister(){
  const email=document.getElementById('regEmail').value.trim();
  const name=document.getElementById('regName').value.trim();
  const pwd=document.getElementById('regPwd').value.trim();
  if(!email || !name || pwd.length<6){ alert('è«‹å®Œæ•´å¡«å¯«ï¼Œå¯†ç¢¼è‡³å°‘ 6 ç¢¼'); return; }
  setUser({email,name}); updateAuthUI();
  bootstrap.Modal.getInstance(document.getElementById('authModal'))?.hide();
  alert('è¨»å†ŠæˆåŠŸï¼Œå·²ç™»å…¥');
}
function logout(){ clearUser(); updateAuthUI(); alert('å·²ç™»å‡ºï¼Œå›åˆ°è©¦ç”¨æ¨¡å¼ï¼ˆåƒ…ç€è¦½ï¼‰'); }

/* ä¿®æ”¹è³‡æ–™/å¿˜è¨˜å¯†ç¢¼ è¡Œç‚º */
document.getElementById('profileModal')?.addEventListener('show.bs.modal', () => {
  const u = getUser() || {};
  document.getElementById('pfEmail').value = u.email || '';
  document.getElementById('pfName').value  = u.name  || '';
});
function saveProfile(){
  const u = getUser() || {};
  const name = document.getElementById('pfName').value.trim();
  setUser({ ...u, name });
  updateAuthUI();
  bootstrap.Modal.getInstance(document.getElementById('profileModal'))?.hide();
  alert('å·²æ›´æ–°è³‡æ–™ï¼');
}
document.getElementById('resetPwdModal')?.addEventListener('show.bs.modal', () => {
  const u = getUser() || {};
  document.getElementById('fpEmail').value = u.email || '';
});
function sendReset(){
  const email = document.getElementById('fpEmail').value.trim();
  if(!email){ alert('è«‹è¼¸å…¥ Email'); return; }
  bootstrap.Modal.getInstance(document.getElementById('resetPwdModal'))?.hide();
  alert(`å·²å¯„å‡ºé‡è¨­å¯†ç¢¼é€£çµè‡³ï¼š${email}ï¼ˆDemo æ¨¡æ“¬ï¼‰`);
}

/* ===== åˆå§‹åŒ– ===== */
document.addEventListener('DOMContentLoaded', () => {
  renderCards();
  updateAuthUI();
  // è®“å¯†ç¢¼æ¬„ Enter ä¹Ÿèƒ½ç™»å…¥
  document.getElementById('loginPwd')?.addEventListener('keydown', e=>{
    if(e.key==='Enter') handleLogin();
  });
});
</script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
